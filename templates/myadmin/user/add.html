{% extends "myadmin/base.html" %}

{% block main_body %}
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <blockquote class="layui-elem-quote layui-text">
            账号管理
        <span class="layui-breadcrumb" lay-separator=">" >
          <a href="">首页</a>
          <a href="" class="active">账号信息管理</a>
        </span>
        </blockquote>
    </section>
    <!-- Main content -->
    <section class="content container-fluid">
      <div class="layui-row layui-col-space15">
        <div class="layui-col-md4">
          <div class="layui-card">
            <div class="layui-card-header">
                <h2 >添加员工账号信息</h2>
            </div>
            <!-- /.box-header -->
            <!-- form start -->
            <form class="layui-form" action="{% url 'myadmin_user_insert' %}" method="post" id="user-add-tset">
                {% csrf_token %}
              <div class="layui-card-body">
                <div class="layui-form-item">
                  <div class="layui-input-wrap">
                    <div class="layui-input-prefix">
                      <i class="layui-icon layui-icon-username"></i>
                    </div>
                      <input type="text" name="username" value="" lay-verify="required" placeholder="账号" autocomplete="off" class="layui-input" lay-affix="clear">
                  </div>
                </div>

                <div class="layui-form-item">
                  <div class="layui-input-wrap">
                    <div class="layui-input-prefix">
                      <i class="layui-icon layui-icon-username"></i>
                    </div>
                      <input type="text" name="nickname" value="" lay-verify="required" placeholder="昵称" autocomplete="off" class="layui-input" lay-affix="clear">
                  </div>
                </div>

                <div class="layui-form-item">
                  <div class="layui-input-wrap">
                    <div class="layui-input-prefix">
                      <i class="layui-icon layui-icon-password"></i>
                    </div>
                      <input type="password" name="password" value="" lay-verify="required" placeholder="密码" autocomplete="off" class="layui-input" id="reg-password" lay-affix="eye">
                  </div>
                </div>

                <div class="layui-form-item">
                  <div class="layui-input-wrap">
                    <div class="layui-input-prefix">
                      <i class="layui-icon layui-icon-password"></i>
                    </div>
                      <input type="password" name="confirmPassword" value="" lay-verify="required|confirmPassword" placeholder="确认密码" autocomplete="off" class="layui-input" lay-affix="eye">
                  </div>
                </div>
              </div>
              <!-- /.box-body -->
              <div class="box-footer">
                <div class="layui-box">
                  <button type="submit" class="layui-btn btn-primary">提交</button> &nbsp;
                  <button type="reset" class="layui-btn btn-default">重置</button>
                </div>
              </div>

            </form>
          </div>
        </div>
      </div>
    </section>
    <script src="//unpkg.com/layui@2.8.15/dist/layui.js"></script> 
<script>
layui.use(function() {
    let $ = layui.$;
    let form = layui.form;
    let layer = layui.layer;
    let util = layui.util;

    function submintForm(){
        let formData = new FormData(document.getElementById('user-add-tset'));

        $.ajax({
          url: {% url 'myadmin_user_insert' %},
          type: 'POST',
          data: formData,
          processData: false,
          contentType: false,
          success: function(response) {
            if (response.success) {
              // 注册成功的处理逻辑
              layer.msg(response.message);
              // 其他操作...
            } else {
              // 注册失败的处理逻辑
              layer.msg(response.message);
              // 其他操作...
            }
          },
          error: function(xhr, textStatus, errorThrown) {
            // 请求错误的处理逻辑
            console.log(errorThrown);
          }
        });
    }
{#    {% for message in messages %}#}
{#    layer.msg('{{ message }}');#}
{#    {% endfor %}#}
    // 自定义验证规则
    form.verify({
        // 确认密码
        confirmPassword: function (value, item) {
            let passwordValue = $('#reg-password').val();
            if (value !== passwordValue) {
                return '两次密码输入不一致';
            }
        }
    });
    //提交事件
    form.on('submit(demo-login)', function(data) {
        let field = data.field; // 获取表单字段值
        // 显示填写结果，仅作演示用
        layer.alert(JSON.stringify(field), {
            title: '当前填写的字段值'
        });
        return false;//阻止默认form跳转
    })


})
</script>
{% endblock %}